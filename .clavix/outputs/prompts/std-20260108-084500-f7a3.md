---
id: std-20260108-084500-f7a3
depthUsed: standard
timestamp: 2026-01-08T08:45:00Z
executed: false
originalPrompt: "Fastform generates the app spec, shows preview, user iterates until satisfied, deploys to staging, tests, then promotes to production"
---

# Improved Prompt

**User Flow: Chat-to-Deploy for Healthcare Mini-Apps**

**Step 1: Intent Capture & AppSpec Generation**
- User types natural language description in chat UI (`/apps/[appId]/chats/[chatId]`)
- System calls ChatGPT/Claude API with full conversation history
- LLM generates draft AppSpec (JSON) stored in memory
- Heuristic generates app name/slug immediately for responsive UX

**Step 2: Intent Confirmation (Rich Chat Message)**
- System displays confirmation as chat message with rich component:
  - Feature preview (pages, fields, workflow states, roles)
  - Proposed app name (editable)
  - Proposed URL slug (editable)
  - Action buttons: "Confirm & Build" | "Let me describe more..."
- Draft AppSpec remains in memory (not persisted yet)

**Step 3: Iterative Refinement (Optional)**
- User continues chatting naturally to refine requirements
- Each message triggers full AppSpec regeneration (not patching)
- Prompt Compiler transforms updated AppSpec → v0 prompt (deterministic)
- v0 SDK generates new code + preview URL
- Preview updates in real-time in right panel/bottom toolbar

**Step 4: Confirmation & Persistence**
- User clicks "Confirm & Build"
- AppSpec persisted to `apps.spec` JSONB column in PostgreSQL
- v0 preview becomes stable reference
- "Deploy to Staging" button becomes active

**Step 5: Staging Deployment**
- User clicks "Deploy to Staging"
- Post-processor injects invariant files (auth, analytics, middleware, fastformClient)
- System creates GitHub repo: `getfastform/{userId-prefix}-{appSlug}`
- Commits generated code to `staging` branch
- Vercel auto-deploys to `{appSlug}-staging.getfastform.com`
- Deployment status shown in chat

**Step 6: Staging Testing**
- User tests staging URL:
  - Magic link auth flow works
  - Forms submit to central backend
  - Workflow transitions follow AppSpec rules
  - Staff can review submissions
- User can iterate (back to Step 3) or promote

**Step 7: Production Promotion**
- User clicks "Promote to Production"
- System merges `staging` → `main` branch in GitHub
- Vercel auto-deploys to `{appSlug}.getfastform.com`
- Production URL live within 60 seconds
- Chat shows confirmation with production link

**Technical Components Involved:**
- **Chat UI**: Existing Next.js chat interface with v0-sdk integration
- **LLM Service**: Azure OpenAI or direct API for AppSpec generation
- **Prompt Compiler**: Transforms AppSpec JSON → natural language for v0
- **v0 SDK**: Code generation with preview URL
- **Post-Processor**: File injection + GitHub commit logic
- **GitHub API**: Repo creation, branch management via Octokit
- **Vercel API**: Deployment triggers (or auto via GitHub App)
- **Central Backend**: Multi-tenant API handling submissions, auth, workflow

**Success Criteria:**
- Step 1-2: Draft AppSpec shown within 5 seconds
- Step 3: Preview updates within 10 seconds per iteration
- Step 5: Staging deploy completes within 2 minutes
- Step 6: All auth, data persistence, workflow features functional
- Step 7: Production deploy completes within 60 seconds

## Quality Scores
- **Clarity**: 60% → 90%
- **Efficiency**: 80% → 85%
- **Structure**: 50% → 90%
- **Completeness**: 30% → 85%
- **Actionability**: 40% → 90%
- **Specificity**: 20% → 80%
- **Overall**: 47% → 87% (good)

## Original Prompt
```
Fastform generates the app spec, shows preview, user iterates until satisfied, deploys to staging, tests, then promotes to production
```
